"use strict";(self.webpackChunksinnammanyo_cn=self.webpackChunksinnammanyo_cn||[]).push([[3364],{53226:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>i,contentTitle:()=>l,default:()=>b,frontMatter:()=>o,metadata:()=>p,toc:()=>c});var n=t(87462),r=(t(67294),t(3905)),s=(t(83989),t(74866)),m=t(85162);const o={id:"cv-object-detection-iou",title:"",sidebar_label:"IOU"},l=void 0,p={unversionedId:"cv/object-detection/cv-object-detection-iou",id:"cv/object-detection/cv-object-detection-iou",title:"",description:"IOU \u91cd\u53e0\u5ea6/\u4ea4\u5e76\u6bd4",source:"@site/docs/stack/cv/object-detection/iou.md",sourceDirName:"cv/object-detection",slug:"/cv/object-detection/cv-object-detection-iou",permalink:"/stack/cv/object-detection/cv-object-detection-iou",draft:!1,editUrl:"https://github.com/rcxxx/sinnammanyo.cn/tree/master/docs/stack/cv/object-detection/iou.md",tags:[],version:"current",frontMatter:{id:"cv-object-detection-iou",title:"",sidebar_label:"IOU"},sidebar:"\ud83d\udc40 CV && \ud83e\udde0 ML & DL",previous:{title:"\u8bc4\u4f30\u6307\u6807",permalink:"/stack/cv/object-detection/cv-object-detection-evaluation"},next:{title:"NMS",permalink:"/stack/cv/object-detection/cv-object-detection-nms"}},i={},c=[{value:"IOU \u91cd\u53e0\u5ea6/\u4ea4\u5e76\u6bd4",id:"iou-\u91cd\u53e0\u5ea6\u4ea4\u5e76\u6bd4",level:2},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}],u={toc:c};function b(e){let{components:a,...t}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,t,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"iou-\u91cd\u53e0\u5ea6\u4ea4\u5e76\u6bd4"},"IOU \u91cd\u53e0\u5ea6/\u4ea4\u5e76\u6bd4"),(0,r.kt)("p",null,"IOU(Intersection over Union) \u7528\u4e8e\u8bc4\u4f30\u76ee\u6807\u68c0\u6d4b\u7b97\u6cd5\u4e2d\u9884\u6d4b\u6846\u4e0e\u771f\u5b9e\u6846\u4e4b\u95f4\u7684\u5339\u914d\u7a0b\u5ea6\u7684\u5ea6\u91cf\u65b9\u6cd5\uff0c\u901a\u8fc7\u8ba1\u7b97\u4e24\u6846\u4e4b\u95f4\u4ea4\u96c6\u548c\u5e76\u96c6\u7684\u6bd4\u503c\u6765\u786e\u5b9a\u4ed6\u4eec\u7684\u91cd\u53e0\u7a0b\u5ea6"),(0,r.kt)("div",{className:"math math-display"},(0,r.kt)("span",{parentName:"div",className:"katex-display"},(0,r.kt)("span",{parentName:"span",className:"katex"},(0,r.kt)("span",{parentName:"span",className:"katex-mathml"},(0,r.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,r.kt)("semantics",{parentName:"math"},(0,r.kt)("mrow",{parentName:"semantics"},(0,r.kt)("mi",{parentName:"mrow"},"I"),(0,r.kt)("mi",{parentName:"mrow"},"O"),(0,r.kt)("mi",{parentName:"mrow"},"U"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"B"),(0,r.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,r.kt)("mi",{parentName:"mrow"},"G"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,r.kt)("mo",{parentName:"mrow"},"="),(0,r.kt)("mfrac",{parentName:"mrow"},(0,r.kt)("mrow",{parentName:"mfrac"},(0,r.kt)("mi",{parentName:"mrow"},"A"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"B"),(0,r.kt)("mo",{parentName:"mrow"},"\u2229"),(0,r.kt)("mi",{parentName:"mrow"},"G"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,r.kt)("mrow",{parentName:"mfrac"},(0,r.kt)("mi",{parentName:"mrow"},"A"),(0,r.kt)("mi",{parentName:"mrow"},"r"),(0,r.kt)("mi",{parentName:"mrow"},"e"),(0,r.kt)("mi",{parentName:"mrow"},"a"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,r.kt)("mi",{parentName:"mrow"},"B"),(0,r.kt)("mo",{parentName:"mrow"},"\u222a"),(0,r.kt)("mi",{parentName:"mrow"},"G"),(0,r.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,r.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"IOU(B, G) = \\frac{Area(B \\cap G)}{Area(B \\cup G)}")))),(0,r.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"I"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"U"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,r.kt)("span",{parentName:"span",className:"mpunct"},","),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"G"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,r.kt)("span",{parentName:"span",className:"mrel"},"="),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,r.kt)("span",{parentName:"span",className:"base"},(0,r.kt)("span",{parentName:"span",className:"strut",style:{height:"2.363em",verticalAlign:"-0.936em"}}),(0,r.kt)("span",{parentName:"span",className:"mord"},(0,r.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,r.kt)("span",{parentName:"span",className:"mfrac"},(0,r.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,r.kt)("span",{parentName:"span",className:"vlist-r"},(0,r.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.427em"}},(0,r.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,r.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,r.kt)("span",{parentName:"span",className:"mord"},(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"re"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.kt)("span",{parentName:"span",className:"mbin"},"\u222a"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"G"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")"))),(0,r.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,r.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,r.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,r.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,r.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,r.kt)("span",{parentName:"span",className:"mord"},(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"re"),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,r.kt)("span",{parentName:"span",className:"mopen"},"("),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.kt)("span",{parentName:"span",className:"mbin"},"\u2229"),(0,r.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,r.kt)("span",{parentName:"span",className:"mord mathnormal"},"G"),(0,r.kt)("span",{parentName:"span",className:"mclose"},")")))),(0,r.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,r.kt)("span",{parentName:"span",className:"vlist-r"},(0,r.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.936em"}},(0,r.kt)("span",{parentName:"span"}))))),(0,r.kt)("span",{parentName:"span",className:"mclose nulldelimiter"}))))))),(0,r.kt)("h2",{id:"\u4ee3\u7801\u5b9e\u73b0"},"\u4ee3\u7801\u5b9e\u73b0"),(0,r.kt)(s.Z,{defaultValue:"py",values:[{label:"Python",value:"py"},{label:"C++",value:"cpp"}],mdxType:"Tabs"},(0,r.kt)(m.Z,{value:"py",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-py"},'"""\n      (0, 1)\n     .----------\n    |           |\n    |    (0, 1) |\n    | b_1   .---|-------\n    |      |////|  b_2  |\n    |      |////|       |\n     -----------.       |\n           |   (2, 3)   |\n           |            |\n            ------------.(2, 3)\n\n    tl = (max(b_1[0], b_2[0]), max(b_1[1], b_2[1]))\n    br = (min(b_1[2], b_2[2]), min(b_1[3], b_2[3]))\n"""\ndef iou(box_1, box_2):\n    """\n    return iou score between pred / gt box\n    :param box_1: predict bbox coordinate\n    :param box_2: ground truth bbox coordinate\n    :return: iou score\n    """\n    tl_x = max(box_1[0], box_2[0])\n    tl_y = max(box_1[1], box_2[1])\n    br_x = min(box_1[2], box_2[2])\n    br_y = min(box_1[3], box_2[3])\n    # intersection\n    i = max(0.0, br_x - tl_x + 1.0) * max(0.0, br_y - tl_y + 1.0)\n\n    # union = area_box_1 + area_box_2 - i\n    area_1 = (box_1[2] - box_1[0] + 1.0) * (box_1[3] - box_1[1] + 1.0)\n    area_2 = (box_2[2] - box_2[0] + 1.0) * (box_2[3] - box_2[1] + 1.0)\n    u = area_1 + area_2 - i\n\n    # iou\n    iou = i / u\n    return iou\n'))),(0,r.kt)(m.Z,{value:"cpp",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <iostream>\n#include <algorithm>\n\n/*\n      (0, 1)\n     .----------\n    |           |\n    |    (0, 1) |\n    | b_1   .---|-------\n    |      |////|  b_2  |\n    |      |////|       |\n     -----------.       |\n           |   (2, 3)   |\n           |            |\n            ------------.(2, 3)\n\n    tl = (max(b_1[0], b_2[0]), max(b_1[1], b_2[1]))\n    br = (min(b_1[2], b_2[2]), min(b_1[3], b_2[3]))\n*/\n/**\n * @brief: return iou score between pred / gt box\n * @param box_1: predict bbox coordinate\n * @param box_2: ground truth bbox coordinate\n * @return: iou score\n */\nfloat iou(const float* box_1, const float* box_2) {\n    float tl_x = std::max(box_1[0], box_2[0]);\n    float tl_y = std::max(box_1[1], box_2[1]);\n    float br_x = std::min(box_1[2], box_2[2]);\n    float br_y = std::min(box_1[3], box_2[3]);\n\n    float i = std::max(0.0f, br_x - tl_x + 1.0f) * std::max(0.0f, br_y - tl_y + 1.0f);\n\n    float area_1 = (box_1[2] - box_1[0] + 1.0f) * (box_1[3] - box_1[1] + 1.0f);\n    float area_2 = (box_2[2] - box_2[0] + 1.0f) * (box_2[3] - box_2[1] + 1.0f);\n    float u = area_1 + area_2 - i;\n\n    float iou = i / u;\n    return iou;\n}\n")))),(0,r.kt)("p",null,"\u5728\u76ee\u6807\u68c0\u6d4b\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528IOU\u6765\u8bc4\u4f30\u9884\u6d4b\u6846\u548c\u771f\u5b9e\u6846\u4e4b\u95f4\u7684\u5339\u914d\u7a0b\u5ea6\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4e00\u4e2a\u9884\u6d4b\u6846\u4e0e\u67d0\u4e2a\u771f\u5b9e\u6846\u7684IOU\u5927\u4e8e\u4e00\u4e2a\u9884\u5148\u5b9a\u4e49\u7684\u9608\u503c\uff08\u59820.5\u62160.7\uff09\uff0c\u5219\u8ba4\u4e3a\u8be5\u9884\u6d4b\u6846\u4e0e\u771f\u5b9e\u6846\u5339\u914d\u6210\u529f\uff0c\u5426\u5219\u8ba4\u4e3a\u5339\u914d\u5931\u8d25"),(0,r.kt)("p",null,"\u5728\u8bad\u7ec3\u76ee\u6807\u68c0\u6d4b\u6a21\u578b\u65f6\uff0c\u53ef\u4ee5\u5c06IOU\u4f5c\u4e3a\u635f\u5931\u51fd\u6570\u7684\u4e00\u90e8\u5206\uff0c\u901a\u8fc7\u6700\u5c0f\u5316\u9884\u6d4b\u6846\u548c\u771f\u5b9e\u6846\u4e4b\u95f4\u7684IOU\u6765\u4f18\u5316\u6a21\u578b\u3002\u540c\u65f6\uff0c\u5728\u6d4b\u8bd5\u9636\u6bb5\uff0c\u53ef\u4ee5\u4f7f\u7528IOU\u6765\u8bc4\u4f30\u6a21\u578b\u7684\u6027\u80fd\uff0c\u5982\u8ba1\u7b97\u5e73\u5747\u7cbe\u5ea6\uff08Average Precision\uff0cAP\uff09\u7b49\u6307\u6807\uff0c\u4ee5\u8bc4\u4f30\u6a21\u578b\u5728\u4e0d\u540cIOU\u9608\u503c\u4e0b\u7684\u8868\u73b0"),(0,r.kt)("h2",{id:"\u53c2\u8003"},"\u53c2\u8003"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("a",{parentName:"strong",href:"https://github.com/amusi/Deep-Learning-Interview-Book/blob/master/docs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89.md#iou"},"amusi/Deep-Learning-Interview-Book/blob/master/docs/\u8ba1\u7b97\u673a\u89c6\u89c9.md#iou"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("a",{parentName:"strong",href:"https://blog.csdn.net/u014061630/article/details/82818112"},"\u76ee\u6807\u68c0\u6d4b\u4e4b IoU")))))}b.isMDXComponent=!0},85162:(e,a,t)=>{t.d(a,{Z:()=>m});var n=t(67294),r=t(86010);const s="tabItem_Ymn6";function m(e){let{children:a,hidden:t,className:m}=e;return n.createElement("div",{role:"tabpanel",className:(0,r.Z)(s,m),hidden:t},a)}},74866:(e,a,t)=>{t.d(a,{Z:()=>g});var n=t(87462),r=t(67294),s=t(86010),m=t(12466),o=t(16550),l=t(91980),p=t(67392),i=t(50012);function c(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:a,label:t,attributes:n,default:r}}=e;return{value:a,label:t,attributes:n,default:r}}))}function u(e){const{values:a,children:t}=e;return(0,r.useMemo)((()=>{const e=a??c(t);return function(e){const a=(0,p.l)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function b(e){let{value:a,tabValues:t}=e;return t.some((e=>e.value===a))}function N(e){let{queryString:a=!1,groupId:t}=e;const n=(0,o.k6)(),s=function(e){let{queryString:a=!1,groupId:t}=e;if("string"==typeof a)return a;if(!1===a)return null;if(!0===a&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:a,groupId:t});return[(0,l._X)(s),(0,r.useCallback)((e=>{if(!s)return;const a=new URLSearchParams(n.location.search);a.set(s,e),n.replace({...n.location,search:a.toString()})}),[s,n])]}function d(e){const{defaultValue:a,queryString:t=!1,groupId:n}=e,s=u(e),[m,o]=(0,r.useState)((()=>function(e){let{defaultValue:a,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(a){if(!b({value:a,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${a}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return a}const n=t.find((e=>e.default))??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:a,tabValues:s}))),[l,p]=N({queryString:t,groupId:n}),[c,d]=function(e){let{groupId:a}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(a),[n,s]=(0,i.Nk)(t);return[n,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:n}),k=(()=>{const e=l??c;return b({value:e,tabValues:s})?e:null})();(0,r.useLayoutEffect)((()=>{k&&o(k)}),[k]);return{selectedValue:m,selectValue:(0,r.useCallback)((e=>{if(!b({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),p(e),d(e)}),[p,d,s]),tabValues:s}}var k=t(72389);const h="tabList__CuJ",f="tabItem_LNqP";function _(e){let{className:a,block:t,selectedValue:o,selectValue:l,tabValues:p}=e;const i=[],{blockElementScrollPositionUntilNextRender:c}=(0,m.o5)(),u=e=>{const a=e.currentTarget,t=i.indexOf(a),n=p[t].value;n!==o&&(c(a),l(n))},b=e=>{let a=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const t=i.indexOf(e.currentTarget)+1;a=i[t]??i[0];break}case"ArrowLeft":{const t=i.indexOf(e.currentTarget)-1;a=i[t]??i[i.length-1];break}}a?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":t},a)},p.map((e=>{let{value:a,label:t,attributes:m}=e;return r.createElement("li",(0,n.Z)({role:"tab",tabIndex:o===a?0:-1,"aria-selected":o===a,key:a,ref:e=>i.push(e),onKeyDown:b,onClick:u},m,{className:(0,s.Z)("tabs__item",f,m?.className,{"tabs__item--active":o===a})}),t??a)})))}function x(e){let{lazy:a,children:t,selectedValue:n}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(a){const e=s.find((e=>e.props.value===n));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},s.map(((e,a)=>(0,r.cloneElement)(e,{key:a,hidden:e.props.value!==n}))))}function v(e){const a=d(e);return r.createElement("div",{className:(0,s.Z)("tabs-container",h)},r.createElement(_,(0,n.Z)({},e,a)),r.createElement(x,(0,n.Z)({},e,a)))}function g(e){const a=(0,k.Z)();return r.createElement(v,(0,n.Z)({key:String(a)},e))}}}]);