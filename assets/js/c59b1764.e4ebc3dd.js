"use strict";(self.webpackChunksinnammanyo_cn=self.webpackChunksinnammanyo_cn||[]).push([[4088],{25705:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>p,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>k});var t=n(87462),s=(n(67294),n(3905));n(83989);const r={id:"esp32-freertos-task",title:"",sidebar_label:"Task"},p="ESP32 FreeRTOS Task",l={unversionedId:"devices/esp32/freertos/esp32-freertos-task",id:"devices/esp32/freertos/esp32-freertos-task",title:"",description:"FreeRTOS",source:"@site/docs/stack/devices/esp32/freertos/esp32-freertos-task.md",sourceDirName:"devices/esp32/freertos",slug:"/devices/esp32/freertos/esp32-freertos-task",permalink:"/stack/devices/esp32/freertos/esp32-freertos-task",draft:!1,editUrl:"https://github.com/rcxxx/sinnammanyo.cn/tree/master/docs/stack/devices/esp32/freertos/esp32-freertos-task.md",tags:[],version:"current",frontMatter:{id:"esp32-freertos-task",title:"",sidebar_label:"Task"},sidebar:"\ud83d\udda5\ufe0fdevices&system",previous:{title:"Demo Blink",permalink:"/stack/devices/esp32/get-start/esp32-demo-blink"},next:{title:"Task List",permalink:"/stack/devices/esp32/freertos/esp32-demo-freertos_task_list"}},i={},k=[{value:"FreeRTOS",id:"freertos",level:2},{value:"Task Create",id:"task-create",level:2},{value:"Task Delete",id:"task-delete",level:2},{value:"Task Param Input",id:"task-param-input",level:2}],o={toc:k};function d(e){let{components:a,...n}=e;return(0,s.kt)("wrapper",(0,t.Z)({},o,n,{components:a,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"esp32-freertos-task"},"ESP32 FreeRTOS Task"),(0,s.kt)("h2",{id:"freertos"},"FreeRTOS"),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"[FreeRTOS](https://www.freertos.org/)")," \u662f\u5b8c\u5168\u514d\u8d39\u7684\u5b9e\u65f6\u64cd\u4f5c\u7cfb\u7edf"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("em",{parentName:"li"},(0,s.kt)("a",{parentName:"em",href:"https://www.freertos.org/zh-cn-cmn-s/features.html"},"\u5f00\u53d1\u8005\u6587\u6863")))),(0,s.kt)("p",null,"ESP-IDF \u4e2d\u5df2\u7ecf\u79fb\u690d\u4e86 FreeRTOS"),(0,s.kt)("h2",{id:"task-create"},"Task Create"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},"BaseType_t xTaskCreate(    TaskFunction_t pvTaskCode,\n                        const char * const pcName,\n                        configSTACK_DEPTH_TYPE usStackDepth,\n                        void *pvParameters,\n                        UBaseType_t uxPriority,\n                        TaskHandle_t *pxCreatedTask\n                        );\n")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"pvTaskCode")," \u4efb\u52a1\u5165\u53e3\u51fd\u6570\u6307\u9488"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"pcName")," \u4efb\u52a1\u540d\u79f0"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"usStackDepth")," \u5206\u914d\u7684\u5806\u6808\u7a7a\u95f4"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"pvParameters")," \u4f20\u9012\u7ed9\u4efb\u52a1\u51fd\u6570\u7684\u53c2\u6570"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"uxPriority")," \u4efb\u52a1\u4f18\u5148\u7ea7"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"pxCreatedTask")," \u4efb\u52a1\u53e5\u67c4")),(0,s.kt)("p",null,"\u7528\u6cd5\u793a\u4f8b"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask( void * pvParameters )\n{\n    while(1) {\n        ESP_LOGI("app", "Running......");\n        vTaskDelay(1000 / portTICK_PERIOD_MS);\n    }\n}\n\nvoid app_main(void)\n{\n    BaseType_t xReturned;\n    TaskHandle_t xHandle = NULL;\n\n    xReturned = xTaskCreate(appTask, "appTask", 1024 * 2, NULL, 1, xHandle);\n}\n')),(0,s.kt)("h2",{id:"task-delete"},"Task Delete"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},"void vTaskDelete( TaskHandle_t xTask );\n")),(0,s.kt)("p",null,"\u7528\u6cd5\u793a\u4f8b"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask( void * pvParameters )\n{\n    // ...\n}\n\nvoid app_main(void)\n{\n    BaseType_t xReturned;\n    TaskHandle_t xHandle = NULL;\n\n    xReturned = xTaskCreate(appTask, "appTask", 1024 * 2, NULL, 1, xHandle);\n\n    // if (xReturned == pdPASS){\n    //     vTaskDelete(xHandle);\n    // }\n    if (xHandle != NULL) {\n        vTaskDelete(xHandle);\n    }\n}\n')),(0,s.kt)("p",null,"\u6216\u8005\u5728\u4efb\u52a1\u7ed3\u675f\u65f6\u81ea\u884c delete"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask( void * pvParameters )\n{\n    // ...\n    vTaskDelete(NULL);\n}\n\nvoid app_main(void){\n    xTaskCreate(appTask, "appTask", 1024 * 2, NULL, 1, NULL);\n\n}\n')),(0,s.kt)("h2",{id:"task-param-input"},"Task Param Input"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"int \u6574\u578b")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask_int(void *pvParameters)\n{\n    int num = *((int*)pvParameters);\n    ESP_LOGI("App Task", "num: %d\\n", num);\n    vTaskDelay(500 / portTICK_PERIOD_MS);\n    vTaskDelete(NULL);\n}\n\nvoid app_main(void)\n{\n    int num = 1;\n    xTaskCreate(appTask_int, "App Task int", 1024 * 2, (void *)&num, 1, NULL);\n\n}\n')),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"array \u6570\u7ec4")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask_array( void * pvParameters )\n{\n    int *p_array = (int *)pvParameters;\n    ESP_LOGI("App Task", "array %d\\n", *p_array);\n    for (int i = 0; i < sizeof(p_array); ++i){\n        ESP_LOGI("App Task", "num %d: %d\\n", i+1, *(p_array + i));\n    }\n    vTaskDelay(500 / portTICK_PERIOD_MS);\n    vTaskDelete(NULL);\n}\n\nvoid app_main(void)\n{\n    int nums[] = {1, 2, 3, 4};\n    xTaskCreate(appTask_array, "App Task array", 1024 * 2, (void *)nums, 1, NULL);\n    vTaskDelay(2000 / portTICK_PERIOD_MS);\n}\n')),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"struct \u7ed3\u6784\u4f53")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'typedef struct Num_Struct {\n    int num_1;\n    int num_2;\n}Num_t;\n\nvoid appTask_struct( void * pvParameters )\n{\n    Num_t *p_num_t = (Num_t *)pvParameters;\n    ESP_LOGI("App Task", "num 1: %d, num 2: %d\\n", p_num_t->num_1, p_num_t->num_2);\n    vTaskDelay(500 / portTICK_PERIOD_MS);\n    vTaskDelete(NULL);\n}\n\nvoid app_main(void)\n{\n    Num_t num_t = {\n        .num_1 = 1,\n        .num_2 = 2,\n    };\n    xTaskCreate(appTask, "appTask", 1024 * 2, (void *)&num_t, 1, NULL);\n}\n')),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\u5b57\u7b26\u4e32")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-c"},'void appTask_str( void * pvParameters )\n{\n    char *p_text = (char *)pvParameters;\n    ESP_LOGI("App Task", "message: %s\\n", p_text);\n    vTaskDelay(500 / portTICK_PERIOD_MS);\n    vTaskDelete(NULL);\n}\n\nvoid app_main(void)\n{\n    const char *p_text = "Hello World!";\n    xTaskCreate(appTask_str, "App Task str", 1024 * 2, (void *)p_text, 1, NULL);\n}\n')),(0,s.kt)("admonition",{type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"\u7531\u4e8e\u4f7f\u7528\u6307\u9488\u8fdb\u884c\u53c2\u6570\u4f20\u9012\uff0c\u80fd\u591f\u4f20\u5165\u5404\u79cd\u9700\u8981\u7684\u53c2\u6570\uff0c\u4f46\u662f\u9700\u8981\u4fdd\u8bc1\u5728\u4efb\u52a1\u7ed3\u675f\u4e4b\u524d\uff0c\u4f20\u5165\u7684\u6307\u9488\u53c2\u6570\u4e0d\u80fd\u88ab\u4fee\u6539")))}d.isMDXComponent=!0}}]);